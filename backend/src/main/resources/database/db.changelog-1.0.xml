<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
	<changeSet id="0" author="basil">
		<createTable tableName="PLAYER">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="first_name" type="VARCHAR(64)">
				<constraints nullable="false" />
			</column>
			<column name="last_name" type="VARCHAR(64)">
				<constraints nullable="false" />
			</column>
			<column name="gender" type="VARCHAR(6)" defaultValue="NA">
				<constraints nullable="false" />
			</column>
			<column name="is_registered" type="BOOLEAN"
				defaultValueBoolean="false">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="1" author="basil">
		<createTable tableName="LOCATION">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="city" type="VARCHAR(255)" />
			<column name="street" type="VARCHAR(255)" />
			<column name="zip_code" type="BIGINT" />
			<column name="country" type="VARCHAR(255)" />
			<column name="country_code" type="VARCHAR(3)" />
			<column name="longitude" type="java.sql.Types.DOUBLE" />
			<column name="latitude" type="java.sql.Types.DOUBLE" />
			<column name="additional_info" type="TEXT" />
		</createTable>
	</changeSet>
	<changeSet id="2" author="bas">
		<createTable tableName="FEE">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="fee_type" type="VARCHAR(10)">
				<constraints nullable="false" />
			</column>
			<column name="amount" type="VARCHAR(10)">
				<constraints nullable="false" />
			</column>
			<column name="currency" type="VARCHAR(3)">
				<constraints nullable="false" />
			</column>
			<column name="alternative_name" type="VARCHAR(100)" />
		</createTable>
	</changeSet>
	<changeSet id="3" author="basil">
		<createTable tableName="SEASON">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="surface" type="VARCHAR(10)" defaultValue="TURF">
				<constraints nullable="false" />
			</column>
			<column name="season_year" type="SMALLINT">
				<constraints nullable="false" />
			</column>
			<column name="plusOneYear" type="BOOLEAN" defaultValueBoolean="false">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addUniqueConstraint constraintName="uk_season_surface_year"
			columnNames="surface, season_year, plusOneYear" tableName="SEASON" />
	</changeSet>
	<changeSet id="4" author="basil">
		<createTable tableName="DFV_PLAYER">
			<column name="player_id" type="BIGINT" autoIncrement="false">
				<constraints primaryKey="false" nullable="false" />
			</column>
			<column name="birth_date" type="DATE">
				<constraints nullable="false" />
			</column>
			<column name="dfv_number" type="java.sql.types.VARCHAR(10)">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addUniqueConstraint constraintName="uk_dfv_player_dfv_number"
			columnNames="dfv_number" tableName="DFV_PLAYER" />
		<addForeignKeyConstraint constraintName="fk_dfv_player_player"
			referencedTableName="PLAYER" baseColumnNames="player_id"
			baseTableName="DFV_PLAYER" referencedColumnNames="id" onDelete="CASCADE" />
	</changeSet>
	<changeSet id="5" author="basil">
		<createTable tableName="ULTICAL_USER">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="email" type="java.sql.types.VARCHAR(256)">
				<constraints nullable="false" />
			</column>
			<column name="password" type="java.sql.types.VARCHAR(128)">
				<constraints nullable="false" />
			</column>
			<column name="dfv_player" type="BIGINT">
				<constraints nullable="true" />
			</column>
			<column name="email_confirmed" type="BOOLEAN"
				defaultValueBoolean="false"></column>
			<column name="dfv_email_opt_in" type="BOOLEAN"
				defaultValueBoolean="false"></column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_ultical_user_dfv_player"
			referencedTableName="PLAYER" baseColumnNames="dfv_player"
			baseTableName="ULTICAL_USER" referencedColumnNames="id" onDelete="SET NULL" />
	</changeSet>
	<changeSet id="6" author="basil">
		<createTable tableName="UNREGISTERED_PLAYER">
			<column name="player_id" type="BIGINT" autoIncrement="false">
				<constraints primaryKey="false" nullable="false" />
			</column>
			<column name="email" type="VARCHAR(256)">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_unregistered_player_player"
			referencedTableName="PLAYER" baseColumnNames="player_id"
			baseTableName="UNREGISTERED_PLAYER" referencedColumnNames="id"
			onDelete="CASCADE" />
	</changeSet>
	<changeSet id="7" author="bas">
		<createTable tableName="CONTACT">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="email" type="VARCHAR(100)" />
			<column name="name" type="VARCHAR(100)" />
			<column name="phone" type="VARCHAR(50)" />
		</createTable>
	</changeSet>
	<changeSet id="8" author="basil">
		<createTable tableName="TOURNAMENT_FORMAT">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="name" type="VARCHAR(256)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="TEXT" />
			<column name="url" type="VARCHAR(255)" />
		</createTable>
	</changeSet>
	<changeSet id="9" author="basil">
		<createTable tableName="TOURNAMENT_EDITION">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="tournament_format" type="BIGINT"
				remarks="reference to the used tourname_format">
				<constraints nullable="true" />
			</column>
			<column name="alternative_name" type="VARCHAR(256)">
				<constraints nullable="true" />
			</column>
			<column name="registration_start" type="DATE">
				<constraints nullable="false" />
			</column>
			<column name="registration_end" type="DATE">
				<constraints nullable="false" />
			</column>
			<column name="season" type="BIGINT"
				remarks="reference to the tournament_edition's season">
				<constraints nullable="false" />
			</column>
			<column name="hashtag" type="VARCHAR(100)" />
			<column name="organizer" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="is_league" type="BOOLEAN" defaultValueBoolean="false">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_tournament_edition_season"
			referencedTableName="SEASON" baseColumnNames="season" baseTableName="TOURNAMENT_EDITION"
			referencedColumnNames="id" />
		<addForeignKeyConstraint constraintName="fk_tournament_edition_tournament_format"
			referencedTableName="TOURNAMENT_FORMAT" baseColumnNames="tournament_format"
			baseTableName="TOURNAMENT_EDITION" referencedColumnNames="id"
			onDelete="CASCADE" />
		<addForeignKeyConstraint constraintName="fk_tournament_edition_contact"
			referencedTableName="CONTACT" baseColumnNames="organizer"
			baseTableName="TOURNAMENT_EDITION" referencedColumnNames="id" />
	</changeSet>
	<!-- <changeSet id="xx" author="basil"> <createTable tableName="TOURNAMENT_EDITION_SINGLE"> 
		<column name="id" type="BIGINT"> <constraints primaryKey="true" nullable="false" 
		foreignKeyName="fk_tournament_edition_single_tournament_edition" referencedTableName="TOURNAMENT_EDITION" 
		referencedColumnNames="id"/> </column> <column name="version" type="BIGINT" 
		defaultValueNumeric="1"> <constraints nullable="false" /> </column> <column 
		name="event" type="BIGINT"> <constraints nullable="true" /> </column> </createTable> 
		</changeSet> -->
	<changeSet id="10" author="basil">
		<createTable tableName="TOURNAMENT_FORMAT_ULTICAL_USERS">
			<column name="tournament_format" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="admin" type="BIGINT">
				<constraints nullable="false"
					foreignKeyName="fk_tournament_format_ultical_users_ultical_users"
					referencedColumnNames="id" referencedTableName="ULTICAL_USER" />
			</column>
		</createTable>
		<addForeignKeyConstraint
			constraintName="fk_tournament_format_ultical_users_tournament_format"
			referencedTableName="TOURNAMENT_FORMAT" baseColumnNames="tournament_format"
			baseTableName="TOURNAMENT_FORMAT_ULTICAL_USERS"
			referencedColumnNames="id" onDelete="CASCADE" />
	</changeSet>
	<changeSet id="11" author="basil">
		<createTable tableName="TOURNAMENT_EDITION_LEAGUE">
			<column name="id" type="BIGINT">
				<constraints primaryKey="true" nullable="false"
					foreignKeyName="fk_tournament_edition_league_tournament_edition"
					referencedTableName="TOURNAMENT_EDITION" referencedColumnNames="id" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="alternative_matchday_name" type="VARCHAR(255)" />
		</createTable>
	</changeSet>
	<changeSet id="12" author="basil">
		<createTable tableName="EVENT">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="matchday_number" type="BIGINT" defaultValue="-1">
				<constraints nullable="false" />
			</column>
			<column name="tournament_edition" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="location" type="BIGINT" />
			<column name="start_date" type="DATE">
				<constraints nullable="false" />
			</column>
			<column name="end_date" type="DATE">
				<constraints nullable="false" />
			</column>
			<column name="local_organizer" type="BIGINT" />
		</createTable>
		<addForeignKeyConstraint constraintName="fk_event_tournament_edition"
			referencedTableName="TOURNAMENT_EDITION" baseColumnNames="tournament_edition"
			baseTableName="EVENT" referencedColumnNames="id" onDelete="CASCADE" />
		<addForeignKeyConstraint constraintName="fk_event_contact"
			referencedTableName="CONTACT" baseColumnNames="local_organizer"
			baseTableName="EVENT" referencedColumnNames="id" />
		<addForeignKeyConstraint constraintName="fk_event_location"
			referencedTableName="LOCATION" baseColumnNames="location"
			baseTableName="EVENT" referencedColumnNames="id" />
	</changeSet>

	<changeSet id="13" author="basil">
		<createTable tableName="DIVISION_REGISTRATION">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="tournament_edition" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="division_type" type="VARCHAR(5)">
				<constraints nullable="false" />
			</column>
			<column name="division_age" type="VARCHAR(12)">
				<constraints nullable="false" />
			</column>
			<column name="number_of_spots" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="is_player_registration" type="BOOLEAN"
				defaultValueBoolean="false">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_division_registration_tournament_edition"
			referencedTableName="TOURNAMENT_EDITION" baseColumnNames="tournament_edition"
			baseTableName="DIVISION_REGISTRATION" referencedColumnNames="id"
			onDelete="CASCADE" />
		<addUniqueConstraint columnNames="tournament_edition, division_type, division_age"
			tableName="DIVISION_REGISTRATION" />
	</changeSet>
	<changeSet id="14" author="basil">
		<createTable tableName="TEAM_REGISTRATION">
			<column name="division_registration" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="sequence" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="time_registered" type="TIMESTAMP"
				defaultValueComputed="CURRENT_TIMESTAMP()">
				<constraints nullable="false" />
			</column>
			<column name="team" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="comment" type="TEXT" />
		</createTable>
	</changeSet>
	<changeSet id="15" author="basil">
		<createTable tableName="TEAM">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="description" type="TEXT" />
			<column name="founding_date" type="INT" />
			<column name="location" type="BIGINT"></column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="name" type="VARCHAR(255)">
				<constraints nullable="false" />
			</column>
			<column name="emails" type="VARCHAR(255)"></column>
			<column name="url" type="VARCHAR(255)"></column>
			<column name="contact_email" type="VARCHAR(255)"></column>
			<column name="twitter_name" type="VARCHAR(255)"></column>
			<column name="facebook_url" type="VARCHAR(255)"></column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_team_location"
			referencedTableName="LOCATION" baseColumnNames="location"
			baseTableName="TEAM" referencedColumnNames="id" />
	</changeSet>
	<changeSet id="16" author="basil">
		<addForeignKeyConstraint constraintName="fk_team_registration_team"
			referencedTableName="TEAM" baseColumnNames="team" baseTableName="TEAM_REGISTRATION"
			referencedColumnNames="id" onDelete="CASCADE" />
	</changeSet>
	<changeSet id="17" author="basil">
		<addForeignKeyConstraint constraintName="fk_team_registration_division_registration"
			referencedTableName="DIVISION_REGISTRATION" baseColumnNames="division_registration"
			baseTableName="TEAM_REGISTRATION" referencedColumnNames="id"
			onDelete="CASCADE" />
	</changeSet>
	<changeSet id="18" author="bas">
		<createTable tableName="DFV_MV_NAME">
			<column name="dfv_number" type="BIGINT">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="first_name" type="VARCHAR(255)">
			</column>
			<column name="last_name" type="VARCHAR(255)">
			</column>
			<column name="dse" type="BOOLEAN" defaultValueBoolean="false">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="19" author="bas">
		<createTable tableName="TEAM_ULTICAL_USERS">
			<column name="team" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="admin" type="BIGINT">
				<constraints nullable="false"
					foreignKeyName="fk_team_ultical_users_ultical_users"
					referencedColumnNames="id" referencedTableName="ULTICAL_USER" />
			</column>
		</createTable>
		<addUniqueConstraint constraintName="uk_team_ultical_users_team_admin"
			columnNames="team, admin" tableName="TEAM_ULTICAL_USERS" />
		<addForeignKeyConstraint constraintName="fk_team_ultical_users_team"
			referencedTableName="TEAM" baseColumnNames="team" baseTableName="TEAM_ULTICAL_USERS"
			referencedColumnNames="id" onDelete="CASCADE" />
	</changeSet>
	<changeSet id="20" author="bas">
		<createTable tableName="ROSTER">
			<column name="id" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="BIGINT" defaultValueNumeric="1">
				<constraints nullable="false" />
			</column>
			<column name="team" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="season" type="BIGINT">
				<constraints nullable="false" foreignKeyName="fk_roster_season"
					referencedColumnNames="id" referencedTableName="SEASON" />
			</column>
			<column name="division_age" type="VARCHAR(12)">
				<constraints nullable="false" />
			</column>
			<column name="division_type" type="VARCHAR(5)">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_roster_team"
			referencedTableName="TEAM" baseColumnNames="team" baseTableName="ROSTER"
			referencedColumnNames="id" onDelete="CASCADE" />
		<addUniqueConstraint constraintName="uk_roster_team_season_division"
			columnNames="team, season, division_type, division_age" tableName="ROSTER" />
	</changeSet>
	<changeSet id="21" author="bas">
		<createTable tableName="ROSTER_PLAYERS">
			<column name="roster" type="BIGINT">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="player" type="BIGINT">
				<constraints primaryKey="true" nullable="false"
					foreignKeyName="fk_roster_players_player" referencedColumnNames="id"
					referencedTableName="PLAYER" />
			</column>
			<column name="date_added" type="TIMESTAMP"
				defaultValueComputed="CURRENT_TIMESTAMP()">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_roster_players_roster"
			referencedTableName="ROSTER" referencedColumnNames="id"
			baseTableName="ROSTER_PLAYERS" baseColumnNames="roster" onDelete="CASCADE" />
	</changeSet>
	<changeSet id="22" author="bas">
		<createTable tableName="MAIL_CODE">
			<column name="ultical_user" type="BIGINT">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="time_created" type="TIMESTAMP"
				defaultValueComputed="CURRENT_TIMESTAMP()">
				<constraints nullable="false" />
			</column>
			<column name="mail_code_type" type="VARCHAR(16)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="code" type="VARCHAR(100)">
				<constraints primaryKey="true" unique="true"
					uniqueConstraintName="uk_mail_code_code" nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_mail_code_ultical_user"
			referencedTableName="ULTICAL_USER" referencedColumnNames="id"
			baseTableName="MAIL_CODE" baseColumnNames="ultical_user" onDelete="CASCADE" />
	</changeSet>

	<changeSet id="23" author="bas">
		<createTable tableName="FEE_TOURNAMENT_EDITION">
			<column name="fee" type="BIGINT">
				<constraints primaryKey="true" nullable="false"></constraints>
			</column>
			<column name="tournament_edition" type="BIGINT">
				<constraints primaryKey="true" nullable="false"></constraints>
			</column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_fee_tournament_edition_fee"
			referencedTableName="FEE" referencedColumnNames="id"
			baseTableName="FEE_TOURNAMENT_EDITION" baseColumnNames="fee"
			onDelete="CASCADE" />
		<addForeignKeyConstraint
			constraintName="fk_fee_tournament_edition_tournament_edition"
			referencedTableName="TOURNAMENT_EDITION" referencedColumnNames="id"
			baseTableName="FEE_TOURNAMENT_EDITION" baseColumnNames="tournament_edition"
			onDelete="CASCADE" />
	</changeSet>
	<changeSet id="24" author="bas">
		<createTable tableName="FEE_EVENT">
			<column name="fee" type="BIGINT">
				<constraints primaryKey="true" nullable="false"></constraints>
			</column>
			<column name="event" type="BIGINT">
				<constraints primaryKey="true" nullable="false"></constraints>
			</column>
		</createTable>
		<addForeignKeyConstraint constraintName="fk_fee_event_fee"
			referencedTableName="FEE" referencedColumnNames="id" baseTableName="FEE_EVENT"
			baseColumnNames="fee" onDelete="CASCADE" />
		<addForeignKeyConstraint constraintName="fk_fee_event_event"
			referencedTableName="EVENT" referencedColumnNames="id" baseTableName="FEE_EVENT"
			baseColumnNames="event" onDelete="CASCADE" />
	</changeSet>
	<changeSet id="25" author="bas">
		<createTable tableName="CLUB">
			<column name="id" type="BIGINT">
				<constraints primaryKey="true" nullable="false"></constraints>
			</column>
			<column name="name" type="VARCHAR(255)">
				<constraints nullable="false"></constraints>
			</column>
			<column name="association" type="BIGINT">
			</column>
		</createTable>
	</changeSet>
	<changeSet author="bas" id="26">
		<addColumn tableName="DFV_PLAYER">
			<column name="club" type="BIGINT" />
		</addColumn>
	</changeSet>
</databaseChangeLog>